<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beta Requests — Admin — sfpermits.ai</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <header style="display:flex; align-items:center; justify-content:space-between; padding:16px 0; border-bottom:2px solid #2563eb; margin-bottom:24px;">
        <a href="/" style="text-decoration:none;">
            <span style="font-size:1.4rem; font-weight:800; color:#2563eb; letter-spacing:-0.5px;">sfpermits.ai</span>
        </a>
        <nav style="display:flex; gap:16px; font-size:0.9rem;">
            <a href="/admin/feedback" style="color:#6b7280;">Feedback</a>
            <a href="/admin/beta-requests" style="color:#1d4ed8; font-weight:600;">Beta Requests</a>
            <a href="/admin/ops" style="color:#6b7280;">Ops</a>
        </nav>
    </header>

    <h1 style="font-size:1.4rem; margin:0 0 4px 0;">Beta Access Requests</h1>
    <p style="color:#6b7280; font-size:0.9rem; margin:0 0 24px 0;">
        {{ requests|length }} pending request{{ 's' if requests|length != 1 else '' }}
    </p>

    {% if flash_message %}
    <div style="background:#f0fdf4; border:1px solid #bbf7d0; color:#166534; padding:12px 16px; border-radius:8px; margin-bottom:20px; font-size:0.9rem;">
        {{ flash_message }}
    </div>
    {% endif %}

    {% if not requests %}
    <div style="text-align:center; padding:48px 0; color:#6b7280;">
        <p style="font-size:1rem;">No pending beta requests.</p>
    </div>
    {% else %}
    <div style="display:flex; flex-direction:column; gap:12px;">
        {% for req in requests %}
        <div style="background:white; border:1px solid #e5e7eb; border-radius:10px; padding:20px;">
            <div style="display:flex; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; gap:12px;">
                <div>
                    <div style="font-weight:600; color:#111827;">{{ req.email }}</div>
                    {% if req.name %}
                    <div style="font-size:0.875rem; color:#6b7280; margin-top:2px;">{{ req.name }}</div>
                    {% endif %}
                    <div style="font-size:0.8rem; color:#9ca3af; margin-top:4px;">
                        {{ req.created_at.strftime('%B %d, %Y at %H:%M UTC') if req.created_at else 'unknown time' }}
                        {% if req.ip %} &bull; IP: {{ req.ip }}{% endif %}
                    </div>
                </div>
                <div style="display:flex; gap:8px; flex-shrink:0;">
                    <form method="POST" action="/admin/beta-requests/{{ req.id }}/approve" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button type="submit"
                                style="padding:8px 16px; background:#16a34a; color:white; border:none;
                                       border-radius:6px; font-size:0.875rem; font-weight:500; cursor:pointer;">
                            Approve + Send Link
                        </button>
                    </form>
                    <form method="POST" action="/admin/beta-requests/{{ req.id }}/deny" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button type="submit"
                                style="padding:8px 16px; background:#f3f4f6; color:#374151; border:1px solid #d1d5db;
                                       border-radius:6px; font-size:0.875rem; cursor:pointer;">
                            Deny
                        </button>
                    </form>
                </div>
            </div>
            {% if req.reason %}
            <div style="margin-top:12px; padding:12px; background:#f9fafb; border-radius:6px; font-size:0.9rem; color:#374151; line-height:1.5;">
                {{ req.reason }}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
</body>
</html>
