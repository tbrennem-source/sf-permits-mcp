{# showcase_gantt.html — Station Timeline Gantt #}
{# Receives: showcase.station_timeline #}
{% set gantt = showcase.station_timeline %}
<div class="showcase-gantt glass-card"
     data-track="showcase-view"
     data-showcase="gantt"
     style="padding: var(--space-6);">
  <style>
    .gantt-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: var(--space-4);
      margin-bottom: var(--space-5);
      flex-wrap: wrap;
    }
    .gantt-title {
      font-family: var(--sans);
      font-size: var(--text-lg);
      font-weight: 400;
      color: var(--text-primary);
      margin: 0;
    }
    .gantt-permit-id {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--text-secondary);
      margin-top: var(--space-1);
    }
    .gantt-desc {
      font-family: var(--sans);
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-5);
    }
    .gantt-grid {
      display: grid;
      grid-template-columns: 90px 1fr;
      gap: var(--space-2) var(--space-3);
      align-items: center;
    }
    .gantt-label {
      font-family: var(--mono);
      font-size: var(--text-xs);
      font-weight: 400;
      color: var(--text-secondary);
      text-align: right;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .gantt-track {
      position: relative;
      height: 28px;
      background: var(--glass);
      border-radius: var(--radius-sm);
      overflow: visible;
    }
    .gantt-bar {
      position: absolute;
      top: 0;
      height: 100%;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      padding: 0 var(--space-2);
      overflow: hidden;
      transition: transform 1.2s cubic-bezier(0.16, 1, 0.3, 1);
      transform-origin: left center;
    }
    .gantt-bar--approved {
      background: rgba(34, 197, 94, 0.18);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }
    .gantt-bar--comments {
      background: rgba(245, 158, 11, 0.18);
      border: 1px solid rgba(245, 158, 11, 0.3);
    }
    .gantt-bar--current {
      background: rgba(94, 234, 212, 0.15);
      border: 1px solid rgba(94, 234, 212, 0.35);
    }
    .gantt-bar--waiting {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
    }
    .gantt-bar-reviewer {
      font-family: var(--mono);
      font-size: 10px;
      font-weight: 400;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .gantt-bar--approved .gantt-bar-reviewer { color: var(--signal-green); }
    .gantt-bar--comments .gantt-bar-reviewer { color: var(--signal-amber); }
    .gantt-bar--current .gantt-bar-reviewer { color: var(--accent); }
    .gantt-bar--waiting .gantt-bar-reviewer { color: var(--text-tertiary); }
    .gantt-you-are-here {
      position: absolute;
      top: -8px;
      right: 0;
      transform: translateX(50%);
      font-family: var(--mono);
      font-size: 9px;
      color: var(--accent);
      white-space: nowrap;
      background: var(--obsidian-mid);
      padding: 1px 4px;
      border-radius: 3px;
      border: 1px solid rgba(94, 234, 212, 0.25);
    }
    .gantt-axis {
      grid-column: 2;
      display: flex;
      justify-content: space-between;
      margin-top: var(--space-2);
      padding: 0;
    }
    .gantt-axis-label {
      font-family: var(--mono);
      font-size: 9px;
      color: var(--text-tertiary);
    }
    .gantt-legend {
      display: flex;
      gap: var(--space-5);
      margin-top: var(--space-4);
      flex-wrap: wrap;
    }
    .gantt-legend-item {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-family: var(--sans);
      font-size: var(--text-xs);
      color: var(--text-secondary);
    }
    .gantt-legend-dot {
      width: 8px;
      height: 8px;
      border-radius: 2px;
      flex-shrink: 0;
    }
    .gantt-legend-dot--approved { background: var(--dot-green); opacity: 0.7; }
    .gantt-legend-dot--comments { background: var(--dot-amber); opacity: 0.7; }
    .gantt-legend-dot--current  { background: var(--accent); opacity: 0.7; }
    .gantt-cta-row {
      margin-top: var(--space-5);
      padding-top: var(--space-4);
      border-top: 1px solid var(--glass-border);
      display: flex;
      justify-content: flex-end;
    }
    @media (max-width: 600px) {
      .gantt-grid {
        grid-template-columns: 72px 1fr;
      }
    }
  </style>

  <div class="gantt-header">
    <div>
      <h3 class="gantt-title">Station Timeline</h3>
      <div class="gantt-permit-id">Permit {{ gantt.permit }}</div>
    </div>
    <span class="chip">{{ gantt.total_days }} days total</span>
  </div>

  <p class="gantt-desc">{{ gantt.description }}</p>

  <div class="gantt-grid" id="gantt-grid-{{ gantt.permit }}">
    {% for station in gantt.stations %}
    <div class="gantt-label" title="{{ station.label }}">{{ station.name }}</div>
    <div class="gantt-track">
      <div class="gantt-bar gantt-bar--{{ station.status if not station.get('is_current') else 'current' }}"
           data-start="{{ station.start_month }}"
           data-width="{{ station.width_pct }}"
           style="left: {{ station.start_month / 6 * 100 }}%; width: {{ station.width_pct }}%;">
        <span class="gantt-bar-reviewer">{{ station.reviewer }}</span>
        {% if station.get('is_current') %}
        <span class="gantt-you-are-here">you are here</span>
        {% endif %}
      </div>
    </div>
    {% endfor %}

    <div style="grid-column: 1;"></div>
    <div class="gantt-axis">
      {% for label in gantt.axis_labels %}
      <span class="gantt-axis-label">{{ label }}</span>
      {% endfor %}
    </div>
  </div>

  <div class="gantt-legend">
    <div class="gantt-legend-item">
      <span class="gantt-legend-dot gantt-legend-dot--approved"></span>
      <span>Approved</span>
    </div>
    <div class="gantt-legend-item">
      <span class="gantt-legend-dot gantt-legend-dot--comments"></span>
      <span>Comments issued</span>
    </div>
    <div class="gantt-legend-item">
      <span class="gantt-legend-dot gantt-legend-dot--current"></span>
      <span>Current station</span>
    </div>
  </div>

  <div class="gantt-cta-row">
    <a href="/tools/station-predictor?permit={{ gantt.permit }}"
       class="ghost-cta"
       data-track="showcase-click"
       data-showcase="gantt">Try it yourself →</a>
  </div>
</div>
