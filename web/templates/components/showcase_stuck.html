{# showcase_stuck.html — Stuck Permit Diagnosis #}
{# Receives: showcase.stuck_permit #}
{% set stuck = showcase.stuck_permit %}
<div class="showcase-stuck glass-card"
     data-track="showcase-view"
     data-showcase="stuck"
     style="padding: var(--space-6);">
  <style>
    .stuck-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: var(--space-4);
      margin-bottom: var(--space-4);
      flex-wrap: wrap;
    }
    .stuck-title {
      font-family: var(--sans);
      font-size: var(--text-lg);
      font-weight: 400;
      color: var(--text-primary);
      margin: 0;
    }
    .stuck-address {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--text-secondary);
      margin-top: var(--space-1);
    }
    .stuck-severity-badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
      font-family: var(--mono);
      font-size: 10px;
      font-weight: 400;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--signal-red);
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.25);
      padding: 3px 10px;
      border-radius: var(--radius-sm);
      white-space: nowrap;
      flex-shrink: 0;
    }
    .stuck-severity-dot {
      width: 6px;
      height: 6px;
      border-radius: var(--radius-full);
      background: var(--dot-red);
      flex-shrink: 0;
    }
    .stuck-blocks-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-3);
      margin-bottom: var(--space-5);
    }
    .stuck-block-card {
      background: var(--obsidian-light);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-sm);
      padding: var(--space-3) var(--space-4);
    }
    .stuck-block-card--comments {
      border-color: rgba(239, 68, 68, 0.2);
    }
    .stuck-block-card--waiting {
      border-color: rgba(255, 255, 255, 0.06);
    }
    .stuck-block-header {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      margin-bottom: var(--space-2);
    }
    .stuck-block-station {
      font-family: var(--mono);
      font-size: var(--text-sm);
      font-weight: 400;
      color: var(--text-primary);
    }
    .stuck-block-reviewer {
      font-family: var(--sans);
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-1);
    }
    .stuck-block-round {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--signal-amber);
    }
    .stuck-block-date {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--text-tertiary);
      margin-top: var(--space-1);
    }
    .stuck-block-card--waiting .stuck-block-round {
      color: var(--text-tertiary);
    }
    .stuck-playbook {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-sm);
      padding: var(--space-4);
      margin-bottom: var(--space-4);
    }
    .stuck-playbook-title {
      font-family: var(--mono);
      font-size: 10px;
      font-weight: 400;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-secondary);
      margin-bottom: var(--space-3);
    }
    .stuck-playbook-steps {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
      padding: 0;
      margin: 0;
    }
    .stuck-playbook-step {
      display: flex;
      gap: var(--space-3);
      font-family: var(--sans);
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: 1.5;
    }
    .stuck-playbook-num {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--accent);
      flex-shrink: 0;
      width: 16px;
      margin-top: 1px;
    }
    .stuck-impact {
      font-family: var(--mono);
      font-size: var(--text-xs);
      color: var(--signal-amber);
      margin-bottom: var(--space-4);
    }
    .stuck-cta-row {
      padding-top: var(--space-4);
      border-top: 1px solid var(--glass-border);
      display: flex;
      justify-content: flex-end;
    }
    @media (max-width: 520px) {
      .stuck-blocks-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <div class="stuck-header">
    <div>
      <h3 class="stuck-title">Stuck Permit Diagnosis</h3>
      <div class="stuck-address">{{ stuck.address }} · {{ stuck.permit }}</div>
    </div>
    <span class="stuck-severity-badge">
      <span class="stuck-severity-dot"></span>
      {{ stuck.severity }} — {{ stuck.block_count }} SIMULTANEOUS BLOCKS
    </span>
  </div>

  <p style="font-family: var(--sans); font-size: var(--text-sm); color: var(--text-secondary); margin-bottom: var(--space-4);">
    {{ stuck.description }} · {{ stuck.days_stuck }} days at current status
  </p>

  <div class="stuck-blocks-grid">
    {% for block in stuck.blocks %}
    <div class="stuck-block-card stuck-block-card--{{ block.status }}">
      <div class="stuck-block-header">
        <span class="status-dot status-dot--{{ 'red' if block.status == 'comments' else 'amber' }}"></span>
        <span class="stuck-block-station">{{ block.station }}</span>
        <span class="chip">{{ block.station_label }}</span>
      </div>
      <div class="stuck-block-reviewer">{{ block.reviewer }}</div>
      <div class="stuck-block-round">{{ block.round }}</div>
      <div class="stuck-block-date">{{ block.date_issued }}</div>
    </div>
    {% endfor %}
  </div>

  <div class="stuck-playbook">
    <div class="stuck-playbook-title">Intervention Playbook</div>
    <ol class="stuck-playbook-steps">
      {% for step in stuck.playbook %}
      <li class="stuck-playbook-step">
        <span class="stuck-playbook-num">{{ loop.index }}.</span>
        <span>{{ step }}</span>
      </li>
      {% endfor %}
    </ol>
  </div>

  <div class="stuck-impact">
    Timeline impact: {{ stuck.timeline_impact }}
  </div>

  <div class="stuck-cta-row">
    <a href="/tools/stuck-permit?permit={{ stuck.permit }}"
       class="ghost-cta"
       data-track="showcase-click"
       data-showcase="stuck">Try it yourself →</a>
  </div>
</div>
